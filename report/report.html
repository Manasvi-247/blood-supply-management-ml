<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Intelligent Blood Supply Management</title>
    <style>
        @page { size: A4; margin: 2cm; }
        body { font-family: 'Times New Roman', serif; font-size: 11pt; line-height: 1.5; color: #222; max-width: 210mm; margin: 0 auto; padding: 20mm; background: #f5f5f5; }
        @media screen { body { box-shadow: 0 0 20px rgba(0,0,0,0.15); background: white; margin: 20px auto; } }
        h1 { font-size: 20pt; text-align: center; color: #b91c1c; margin-bottom: 5px; }
        .subtitle { font-size: 12pt; text-align: center; margin-bottom: 30px; color: #444; }
        h2 { font-size: 14pt; color: #b91c1c; margin: 25px 0 12px 0; border-bottom: 2px solid #b91c1c; padding-bottom: 5px; }
        h3 { font-size: 12pt; color: #333; margin: 18px 0 8px 0; }
        p { margin: 10px 0; text-align: justify; }
        table { width: 100%; border-collapse: collapse; margin: 15px 0; font-size: 10pt; }
        th { background: #b91c1c; color: white; padding: 8px 10px; text-align: left; }
        td { padding: 7px 10px; border: 1px solid #ddd; }
        tr:nth-child(even) { background: #f5f5f5; }
        ul, ol { margin: 10px 0 10px 25px; }
        li { margin: 5px 0; }
        .highlight { background: #fef2f2; padding: 15px; border-left: 4px solid #b91c1c; margin: 15px 0; }
        .formula { background: #1e3a5f; color: white; padding: 12px 20px; margin: 15px 0; text-align: center; font-family: 'Courier New', monospace; }
        blockquote { border-left: 4px solid #b91c1c; padding: 10px 20px; margin: 20px 0; font-style: italic; background: #fef2f2; }
        .results-summary { background: #fef2f2; border: 2px solid #b91c1c; padding: 20px; margin: 20px 0; text-align: center; }
        .results-summary h3 { color: #b91c1c; margin-bottom: 15px; border: none; }
        .metric { display: inline-block; margin: 0 20px; text-align: center; }
        .metric-value { font-size: 24pt; font-weight: bold; color: #b91c1c; }
        .metric-label { font-size: 9pt; color: #666; }
        .badge { display: inline-block; padding: 2px 8px; border-radius: 10px; font-size: 8pt; font-weight: bold; }
        .badge-high { background: #fee2e2; color: #991b1b; }
        .badge-medium { background: #fef3c7; color: #92400e; }
        .page-break { page-break-before: always; }
        .ref { font-size: 9pt; }
    </style>
</head>
<body>

<h1>Intelligent Blood Supply Management</h1>
<p class="subtitle">Demand Forecasting, Donor Segmentation & Recommender System for Inventory Optimization</p>

<div class="results-summary">
    <h3>Key Results Achieved</h3>
    <div class="metric">
        <div class="metric-value">12.14%</div>
        <div class="metric-label">FORECAST MAPE<br>(Target: &lt;20%)</div>
    </div>
    <div class="metric">
        <div class="metric-value">0.41</div>
        <div class="metric-label">SILHOUETTE SCORE<br>(Target: &gt;0.35)</div>
    </div>
    <div class="metric">
        <div class="metric-value">+47%</div>
        <div class="metric-label">RECOMMENDER<br>IMPROVEMENT</div>
    </div>
</div>

<h2>1. Problem Background & Motivation</h2>

<h3>1.1 The Blood Supply Challenge</h3>
<p>Blood transfusion is a critical life-saving medical intervention with no synthetic substitute available. Blood banks worldwide face a fundamental operational dilemma that impacts both patient outcomes and resource efficiency:</p>

<ul>
    <li><strong>Shortage Risk:</strong> Unpredictable demand spikes from accidents, surgeries, and medical emergencies, combined with variable donor availability, can lead to critical shortages that directly impact patient outcomes and potentially cause loss of life.</li>
    <li><strong>Wastage Risk:</strong> Blood components are highly perishable—platelets expire in just 5 days, while packed red blood cells last 42 days. Overstocking leads to expensive wastage of a precious, voluntarily donated resource.</li>
</ul>

<h3>1.2 Scale of the Problem</h3>
<p>According to the <strong>2019 National Blood Collection and Utilization Survey (NBCUS)</strong>:</p>
<ul>
    <li><strong>13.02 million</strong> donors presented for donation in the United States</li>
    <li><strong>10.8 million</strong> RBC units were transfused to <strong>4.2 million</strong> recipients</li>
    <li>Wastage rates range from <strong>5-15%</strong> depending on component and facility</li>
    <li>Young donor participation (16-24 years) declined by 10.1%, raising sustainability concerns</li>
    <li>Donors aged 65+ increased by 10.5%, creating long-term supply challenges</li>
</ul>

<p>The <strong>Nepal BPKIHS study (2023)</strong> documented <strong>7.13% overall wastage</strong> with 92.9% utilization rate, establishing a benchmark for inventory performance. Platelet concentrates showed the highest wastage rates due to their extremely short shelf life.</p>

<h3>1.3 Project Objectives</h3>
<table>
    <tr><th>Objective</th><th>Technique</th><th>Target Metric</th></tr>
    <tr><td>Demand Forecasting</td><td>SARIMA, Prophet, Random Forest, Gradient Boosting</td><td>MAPE &lt; 20%</td></tr>
    <tr><td>Donor Segmentation</td><td>RFM Analysis + K-Means Clustering</td><td>Silhouette Score &gt; 0.35</td></tr>
    <tr><td>Recommender System</td><td>Hybrid Rule-Based Scoring</td><td>Outperform random selection</td></tr>
    <tr><td>Anomaly Detection</td><td>Rolling Z-score</td><td>Detect demand spikes</td></tr>
</table>

<h2>2. Dataset Description</h2>

<h3>2.1 Data Sources Overview</h3>
<table>
    <tr><th>Dataset</th><th>Records</th><th>Type</th><th>Source</th></tr>
    <tr><td>UCI Blood Transfusion</td><td>748</td><td>Real</td><td>UCI ML Repository</td></tr>
    <tr><td>Kaggle Blood Demand</td><td>-</td><td>Real</td><td>Kaggle</td></tr>
    <tr><td>Kaggle Blood Donor</td><td>-</td><td>Real</td><td>Kaggle</td></tr>
    <tr><td>Synthetic Donor Registry</td><td>10,000</td><td>Synthetic</td><td>NBCUS 2019 statistics</td></tr>
    <tr><td>Demand Time-Series</td><td>4,380</td><td>Synthetic</td><td>3 years daily data</td></tr>
    <tr><td>Supply/Inventory</td><td>4,380</td><td>Synthetic</td><td>Nepal BPKIHS study</td></tr>
</table>

<h3>2.2 UCI Blood Transfusion Dataset (Real Data)</h3>
<p>This dataset from the Blood Transfusion Service Center in Taiwan contains donation behavior of 748 donors:</p>
<table>
    <tr><th>Feature</th><th>Description</th><th>Range</th></tr>
    <tr><td>Recency</td><td>Months since last donation</td><td>0.03 - 74.4</td></tr>
    <tr><td>Frequency</td><td>Total number of donations</td><td>1 - 50</td></tr>
    <tr><td>Monetary</td><td>Total blood donated (cc)</td><td>250 - 12,500</td></tr>
    <tr><td>Time</td><td>Months since first donation</td><td>2.27 - 98.3</td></tr>
    <tr><td>Donated</td><td>Target: donated in March 2007</td><td>Binary (24% positive)</td></tr>
</table>

<h3>2.3 Synthetic Data Generation</h3>
<p>Synthetic datasets were generated based on real-world statistics to ensure realistic patterns:</p>
<ul>
    <li><strong>Blood Types:</strong> WHO distribution (O+: 37%, A+: 28%, B+: 20%, AB+: 5%, O-: 6%, A-: 6%, B-: 2%, AB-: 1%)</li>
    <li><strong>Demographics:</strong> NBCUS 2019 patterns (30% first-time donors, 70% repeat donors; 54% male, 46% female)</li>
    <li><strong>Deferrals:</strong> 15% deferral rate (top reason: low hemoglobin at 43%)</li>
    <li><strong>Demand Patterns:</strong> Weekly seasonality, winter peaks, holiday spikes, random emergency events</li>
</ul>

<div class="page-break"></div>

<h2>3. Methodology & Model Choice</h2>

<h3>3.1 Demand Forecasting Models</h3>
<table>
    <tr><th>Model</th><th>Rationale</th><th>Configuration</th></tr>
    <tr><td>SARIMA</td><td>Explicit seasonality modeling with confidence intervals</td><td>SARIMA(1,1,1)(1,1,1,7)</td></tr>
    <tr><td>Prophet</td><td>Automatic seasonality detection, holiday handling</td><td>Weekly + yearly seasonality</td></tr>
    <tr><td>Random Forest</td><td>Captures non-linear relationships, feature importance</td><td>100 trees, max_depth=10</td></tr>
    <tr><td>Gradient Boosting</td><td>Sequential error correction, handles complex patterns</td><td>100 estimators, lr=0.1</td></tr>
</table>

<p><strong>Feature Engineering:</strong></p>
<ul>
    <li><strong>Time features:</strong> day_of_week, month, quarter, is_weekend, is_holiday_season</li>
    <li><strong>Lag features:</strong> lag_1, lag_7, lag_14, lag_30 (previous demand values)</li>
    <li><strong>Rolling statistics:</strong> rolling_mean_7/14/30, rolling_std_7/14/30</li>
</ul>

<h3>3.2 Donor Segmentation Approach</h3>
<p><strong>RFM Framework</strong> is a proven marketing analytics technique adapted for blood donation:</p>
<ul>
    <li><strong>R</strong>ecency: Months since last donation (lower = better, more engaged)</li>
    <li><strong>F</strong>requency: Total lifetime donations (higher = better, more committed)</li>
    <li><strong>M</strong>onetary: Total blood volume donated in cc (higher = better, greater contribution)</li>
</ul>

<p><strong>Scoring:</strong> Quintile-based scoring (1-5 scale) for each RFM metric, combined to create donor value segments.</p>

<p><strong>Clustering:</strong> K-Means algorithm with optimal K selection via elbow method and silhouette analysis. Target segments: Champions, Loyal, Potential, At Risk, Hibernating.</p>

<h3>3.3 Hybrid Recommender System</h3>
<p>A rule-based hybrid system that matches donors to blood donation campaigns using weighted scoring:</p>

<div class="formula">
Score = 0.4 × RFM + 0.2 × Availability + 0.2 × Segment_Match + 0.1 × Blood_Match + 0.1 × Urgency
</div>

<p><strong>Component Details:</strong></p>
<ul>
    <li><strong>RFM Score (40%):</strong> Normalized donor value score from segmentation (0-1)</li>
    <li><strong>Availability (20%):</strong> Eligibility based on last donation date (56-day minimum gap)</li>
    <li><strong>Segment Match (20%):</strong> Campaign-segment alignment (e.g., reactivation campaigns → At Risk donors)</li>
    <li><strong>Blood Match (10%):</strong> Priority for needed blood types (O- for emergencies)</li>
    <li><strong>Urgency Boost (10%):</strong> Higher weight for critical shortage campaigns</li>
</ul>

<h3>3.4 Anomaly Detection</h3>
<p><strong>Method:</strong> Rolling Z-score with 30-day window and threshold of 2.5σ</p>
<p>This method detects unusual demand spikes from emergencies, seasonal surges, or operational disruptions, enabling proactive inventory management.</p>

<div class="page-break"></div>

<h2>4. Experiments & Results</h2>

<h3>4.1 Demand Forecasting Performance</h3>
<p><strong>Test Setup:</strong> 90-day holdout period (last 3 months of data)</p>

<table>
    <tr><th>Model</th><th>MAE</th><th>RMSE</th><th>MAPE</th><th>R²</th></tr>
    <tr style="background:#fef2f2;font-weight:bold;"><td>Random Forest</td><td>19.68</td><td>29.61</td><td>12.14%</td><td>0.45</td></tr>
    <tr><td>SARIMA</td><td>22.19</td><td>35.65</td><td>12.40%</td><td>0.20</td></tr>
    <tr><td>Gradient Boosting</td><td>22.11</td><td>33.91</td><td>13.75%</td><td>0.28</td></tr>
</table>

<div class="highlight">
<strong>Key Finding:</strong> All models achieved MAPE below the 20% target. Random Forest performed best with 12.14% MAPE and highest R² of 0.45, indicating it captures demand patterns most effectively.
</div>

<p><strong>Top 5 Important Features:</strong></p>
<ol>
    <li>lag_1 (0.42) - Previous day demand is the strongest predictor</li>
    <li>rolling_mean_7 (0.18) - Weekly average captures short-term trends</li>
    <li>lag_7 (0.12) - Same day last week shows weekly patterns</li>
    <li>day_of_week (0.08) - Weekend vs weekday effect</li>
    <li>rolling_std_7 (0.05) - Volatility indicator</li>
</ol>

<p><strong>Time Series Patterns Identified:</strong></p>
<ul>
    <li><strong>Weekly cycle:</strong> 30% lower demand on weekends (reduced elective surgeries)</li>
    <li><strong>Seasonal trend:</strong> +15% demand in winter months (December-February)</li>
    <li><strong>Holiday spikes:</strong> +20-25% during major holidays (Diwali, Christmas)</li>
    <li><strong>Random spikes:</strong> Emergency events visible in residuals</li>
</ul>

<h3>4.2 Donor Segmentation Results</h3>
<p><strong>Clustering Performance:</strong> Silhouette Score = <strong>0.41</strong> (Target: &gt;0.35) ✓</p>

<table>
    <tr><th>Segment</th><th>Count</th><th>%</th><th>Avg Recency</th><th>Avg Frequency</th><th>Strategy</th></tr>
    <tr><td>Champions</td><td>1,151</td><td>11.5%</td><td>1.9 months</td><td>8.2</td><td>Retain & Reward</td></tr>
    <tr><td>Loyal</td><td>2,234</td><td>22.3%</td><td>3.8 months</td><td>5.7</td><td>Referral Programs</td></tr>
    <tr><td>Potential</td><td>2,847</td><td>28.5%</td><td>4.2 months</td><td>2.1</td><td>Nurture & Convert</td></tr>
    <tr><td>At Risk</td><td>1,956</td><td>19.6%</td><td>8.4 months</td><td>4.3</td><td>Urgent Reactivation</td></tr>
    <tr><td>Hibernating</td><td>1,812</td><td>18.1%</td><td>12.1 months</td><td>1.8</td><td>Last-chance Campaign</td></tr>
</table>

<h3>4.3 Recommender System Results</h3>
<p><strong>Campaigns Generated:</strong></p>
<table>
    <tr><th>Campaign</th><th>Target Segment</th><th>Blood Priority</th><th>Urgency</th></tr>
    <tr><td>Winter Blood Drive</td><td>Champions, Loyal</td><td>All types</td><td><span class="badge badge-high">High</span></td></tr>
    <tr><td>O-Negative Emergency</td><td>All eligible O- donors</td><td>O-</td><td><span class="badge badge-high">Critical</span></td></tr>
    <tr><td>Platelet Donation Week</td><td>Champions</td><td>A+, O+</td><td><span class="badge badge-high">High</span></td></tr>
    <tr><td>Summer Stock Building</td><td>Potential</td><td>All types</td><td><span class="badge badge-medium">Medium</span></td></tr>
    <tr><td>Lapsed Donor Reactivation</td><td>At Risk, Hibernating</td><td>All types</td><td><span class="badge badge-medium">Medium</span></td></tr>
</table>

<p><strong>Simulation Results (100 donors, 5 campaigns, 10 simulations):</strong></p>
<table>
    <tr><th>Strategy</th><th>Avg Donations</th><th>Improvement</th></tr>
    <tr><td>Random Selection</td><td>~45</td><td>baseline</td></tr>
    <tr><td>RFM-based Selection</td><td>~58</td><td>+29%</td></tr>
    <tr style="background:#fef2f2;font-weight:bold;"><td>Hybrid Recommender</td><td>~66</td><td>+47%</td></tr>
</table>

<div class="highlight">
<strong>Key Finding:</strong> The hybrid recommender system achieved <strong>47% improvement</strong> over random donor selection, demonstrating the value of intelligent donor-campaign matching.
</div>

<h3>4.4 Anomaly Detection Results</h3>
<p>The rolling Z-score method detected <strong>12 significant anomalies</strong> over the 3-year period, corresponding to:</p>
<ul>
    <li>Winter demand surges (December peaks)</li>
    <li>Holiday-related spikes (festival seasons)</li>
    <li>Simulated emergency events</li>
</ul>

<div class="page-break"></div>

<h2>5. Insights & Business Interpretation</h2>

<h3>5.1 Demand Pattern Insights</h3>
<table>
    <tr><th>Pattern</th><th>Finding</th><th>Business Action</th></tr>
    <tr><td>Weekly</td><td>30% lower demand on weekends</td><td>Reduce weekend collection drives, optimize staff scheduling</td></tr>
    <tr><td>Winter Peak</td><td>+15% demand (Dec-Feb)</td><td>Pre-stock 15-20% buffer before November</td></tr>
    <tr><td>Holiday Spikes</td><td>+20-25% during festivals</td><td>Build emergency reserves, organize pre-holiday drives</td></tr>
    <tr><td>Summer Dip</td><td>-8% (Jun-Aug)</td><td>Intensify donor drives, target corporate donors</td></tr>
</table>

<h3>5.2 Donor Engagement Strategy</h3>
<table>
    <tr><th>Segment</th><th>Strategy</th><th>Channel</th><th>Expected Yield</th></tr>
    <tr><td>Champions</td><td>Retain & Reward</td><td>Personal calls, VIP events</td><td>90%+ retention</td></tr>
    <tr><td>Loyal</td><td>Referral programs</td><td>Email, SMS campaigns</td><td>70-80% engagement</td></tr>
    <tr><td>Potential</td><td>Nurture & Convert</td><td>Education campaigns</td><td>40-50% activation</td></tr>
    <tr><td>At Risk</td><td>Urgent reactivation</td><td>Personal outreach</td><td>30-40% win-back</td></tr>
    <tr><td>Hibernating</td><td>Last-chance campaign</td><td>Direct mail</td><td>10-20% reactivation</td></tr>
</table>

<h3>5.3 Inventory Optimization Recommendations</h3>
<table>
    <tr><th>Component</th><th>Current Wastage</th><th>Shelf Life</th><th>Recommended Strategy</th></tr>
    <tr><td>Platelets</td><td>12.3%</td><td>5 days</td><td>Just-in-time ordering, max 2-day advance</td></tr>
    <tr><td>Packed RBC</td><td>5.2%</td><td>42 days</td><td>Maintain 7-day rolling stock buffer</td></tr>
    <tr><td>Fresh Frozen Plasma</td><td>6.4%</td><td>1 year</td><td>Moderate buffer acceptable</td></tr>
    <tr><td>O-negative</td><td>-</td><td>-</td><td>Priority collection (universal donor, only 6%)</td></tr>
</table>

<h3>5.4 Projected Business Impact</h3>
<table>
    <tr><th>Initiative</th><th>Current State</th><th>Target</th><th>Projected Impact</th></tr>
    <tr><td>Wastage Rate</td><td>8.8%</td><td>5%</td><td>~$150K/year savings</td></tr>
    <tr><td>Donor Outreach</td><td>Random selection</td><td>Recommender system</td><td>+47% donation yield</td></tr>
    <tr><td>Forecast Accuracy</td><td>None</td><td>MAPE &lt;15%</td><td>Reduced emergency procurement</td></tr>
    <tr><td>Donor Retention</td><td>~70%</td><td>85%</td><td>15% more reliable supply</td></tr>
</table>

<h2>6. Limitations & Future Scope</h2>

<h3>6.1 Limitations</h3>
<ul>
    <li><strong>Synthetic Data:</strong> While based on real statistics (NBCUS, BPKIHS, WHO), synthetic data may not capture all real-world complexities. Validation with production hospital data is required before deployment.</li>
    <li><strong>Unpredictable Events:</strong> Emergency events (natural disasters, mass casualty incidents) cannot be forecast by any statistical model.</li>
    <li><strong>External Factors:</strong> Pandemics, policy changes, economic conditions, and social factors are not modeled.</li>
    <li><strong>Implementation Challenges:</strong> Integration with existing hospital information systems, staff training requirements, and regulatory compliance (HIPAA, local regulations) present practical challenges.</li>
</ul>

<h3>6.2 Future Scope</h3>
<table>
    <tr><th>Area</th><th>Opportunity</th></tr>
    <tr><td>Deep Learning</td><td>LSTM/Transformer models for improved sequence modeling</td></tr>
    <tr><td>Reinforcement Learning</td><td>Dynamic inventory policies that adapt to changing conditions</td></tr>
    <tr><td>Real-Time Systems</td><td>IoT cold-chain monitoring, hospital EMR integration</td></tr>
    <tr><td>Personalization</td><td>Individual donor scheduling optimization, mobile app engagement</td></tr>
    <tr><td>Multi-Center Network</td><td>Regional network optimization across multiple blood banks</td></tr>
</table>

<h2>7. Conclusion</h2>

<p>This project demonstrates the successful application of advanced machine learning techniques to blood supply management:</p>

<table>
    <tr><th>Objective</th><th>Target</th><th>Achieved</th><th>Status</th></tr>
    <tr><td>Demand Forecasting</td><td>MAPE &lt; 20%</td><td><strong>12.14%</strong></td><td>✓ Exceeded</td></tr>
    <tr><td>Donor Segmentation</td><td>Silhouette &gt; 0.35</td><td><strong>0.41</strong></td><td>✓ Exceeded</td></tr>
    <tr><td>Recommender System</td><td>Beat random</td><td><strong>+47%</strong></td><td>✓ Exceeded</td></tr>
</table>

<p><strong>Key Takeaways:</strong></p>
<ul>
    <li>Random Forest achieved best forecasting performance with 12.14% MAPE</li>
    <li>RFM-based clustering successfully identified 5 actionable donor segments</li>
    <li>Hybrid recommender improved donor outreach yield by 47% over random selection</li>
    <li>Weekly (30% weekend dip) and seasonal (15% winter peak) patterns enable proactive inventory planning</li>
    <li>Platelets require just-in-time management due to 5-day shelf life</li>
</ul>

<hr>

<h2>References</h2>
<ol class="ref">
    <li>NBCUS (2019). National Blood Collection and Utilization Survey. US Department of Health and Human Services.</li>
    <li>Singh, M., Pradhan, A., & Poudyal, P. (2023). Blood component usage and wastage at BPKIHS. Journal of Pathology of Nepal, 13(1).</li>
    <li>UCI Machine Learning Repository. Blood Transfusion Service Center Dataset. https://archive.ics.uci.edu/dataset/176</li>
    <li>World Health Organization. Blood Safety and Availability Fact Sheet.</li>
    <li>Kaggle. Blood Demand Dataset & Blood Donor Dataset.</li>
</ol>

<hr>
<p style="text-align:center;font-size:9pt;color:#666;">
<em>Code: 5 Jupyter notebooks | Visualizations: data/visualizations/ folder | Data: Google Drive</em>
</p>

</body>
</html>